# Maintainer: Jef Oliver (jef at eljef dot me)

_pkgname=eljef_backup
pkgname=python-eljef-backup
pkgver=2022.10.2
pkgrel=1
pkgdesc="Simple backup program that runs operations as steps."
arch=('aarch64' 'x86_64')
url='https://git.eljef.me/python/eljef_backup'
license=('LGPL2.1')
depends=('python-eljef-core')
makedepends=('git' 'python-build' 'python-installer' 'python-setuptools' 'python-wheel')
optdepends=('bzip2: compress backup plugin'
            'docker: docker plugin'
            'docker-compose: docker-compose plugin'
            'rsync: local rsync plugin'
            'tar: compress backup plugin')
source=("${_pkgname}::git+https://git.eljef.me/python/eljef_backup.git")
sha512sums=('SKIP')

build() {
    cd "${_pkgname}"
    python3 -m build --wheel --no-isolation
}

package() {
    cd "${_pkgname}"
    python3 -m installer --destdir="$pkgdir" dist/*.whl

    install -Dm644 "${srcdir}/${_pkgname}/README.md" "${pkgdir}/usr/doc/${pkgname}/README.md"
    cp -R "${srcdir}/${_pkgname}/configs" "${pkgdir}/usr/doc/${pkgname}/"
}
